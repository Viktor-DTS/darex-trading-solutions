# ТЕСТ РОЗРАХУНКІВ
## Перевірка виправлень обчислень у формі

---

## ПРОБЛЕМА

**Оригінальна проблема:**
- Формула "Загальна сума за антифриз" неправильно обчислювала: 2,5 * 82 = 164 (має бути 205)
- Поля не підтримували десяткові числа з комою як роздільником
- Відображення не показувало два знаки після коми

---

## ВИПРАВЛЕННЯ

### 1. Додано функції для правильного парсингу чисел:

```javascript
// Функція для правильного парсингу чисел з комою як роздільником
const parseNumber = (value) => {
  if (!value) return 0;
  // Замінюємо кому на крапку для правильного парсингу
  const normalizedValue = String(value).replace(',', '.');
  return parseFloat(normalizedValue) || 0;
};

// Функція для форматування чисел з двома знаками після коми
const formatNumber = (value) => {
  if (value === 0 || value === '0') return '0,00';
  return Number(value).toFixed(2).replace('.', ',');
};
```

### 2. Оновлено функції обчислення:

```javascript
// Додаю розрахунок для полів
const calcOilTotal = () => parseNumber(form.oilUsed) * parseNumber(form.oilPrice);
const calcFilterSum = () => parseNumber(form.filterCount) * parseNumber(form.filterPrice);
const calcFuelFilterSum = () => parseNumber(form.fuelFilterCount) * parseNumber(form.fuelFilterPrice);
const calcAirFilterSum = () => parseNumber(form.airFilterCount) * parseNumber(form.airFilterPrice);
const calcAntifreezeSum = () => parseNumber(form.antifreezeL) * parseNumber(form.antifreezePrice);
```

### 3. Оновлено відображення полів:

```javascript
// Приклад для антифризу
if (f.name === 'antifreezeSum') value = formatNumber(calcAntifreezeSum());
```

---

## ТЕСТОВІ КЕЙСИ

### Тест 1: Антифриз
**Вхідні дані:**
- Антифриз, л: 2,5
- Ціна антифризу: 82

**Очікуваний результат:**
- Загальна сума за антифриз: 205,00

**Розрахунок:**
- 2,5 * 82 = 205,00

### Тест 2: Олива
**Вхідні дані:**
- Використано оливи, л: 3,5
- Ціна оливи за 1 л, грн: 45,50

**Очікуваний результат:**
- Загальна сума за оливу, грн: 159,25

**Розрахунок:**
- 3,5 * 45,50 = 159,25

### Тест 3: Масляний фільтр
**Вхідні дані:**
- Фільтр масл. штук: 2
- Ціна одного масляного фільтра: 125,75

**Очікуваний результат:**
- Загальна сума за фільтри масляні: 251,50

**Розрахунок:**
- 2 * 125,75 = 251,50

### Тест 4: Паливний фільтр
**Вхідні дані:**
- Фільтр палив. штук: 1,5
- Ціна одного паливного фільтра: 89,90

**Очікуваний результат:**
- Загальна сума за паливні фільтри: 134,85

**Розрахунок:**
- 1,5 * 89,90 = 134,85

### Тест 5: Повітряний фільтр
**Вхідні дані:**
- Фільтр повітряний штук: 3,25
- Ціна одного повітряного фільтра: 67,40

**Очікуваний результат:**
- Загальна сума за повітряні фільтри: 219,05

**Розрахунок:**
- 3,25 * 67,40 = 219,05

---

## ПЕРЕВІРКА ВСІХ ПОЛІВ

### Поля, які повинні підтримувати десяткові числа:

1. **Використано оливи, л** - підтримує кому як роздільник
2. **Ціна оливи за 1 л, грн** - підтримує кому як роздільник
3. **Загальна сума за оливу, грн** - відображає з двома знаками після коми
4. **Ціна одного масляного фільтра** - підтримує кому як роздільник
5. **Загальна сума за фільтри масляні** - відображає з двома знаками після коми
6. **Ціна одного паливного фільтра** - підтримує кому як роздільник
7. **Загальна сума за паливні фільтри** - відображає з двома знаками після коми
8. **Ціна одного повітряного фільтра** - підтримує кому як роздільник
9. **Загальна сума за повітряні фільтри** - відображає з двома знаками після коми
10. **Ціна антифризу** - підтримує кому як роздільник
11. **Загальна сума за антифриз** - відображає з двома знаками після коми
12. **Загальна вартість тр. витрат** - підтримує кому як роздільник
13. **Вартість робіт, грн** - відображає з двома знаками після коми
14. **Добові, грн** - підтримує кому як роздільник
15. **Проживання, грн** - підтримує кому як роздільник
16. **Інші витрати, грн** - підтримує кому як роздільник
17. **Загальна ціна інших матеріалів** - підтримує кому як роздільник

---

## ІНСТРУКЦІЯ ПО ТЕСТУВАННЮ

### Крок 1: Відкрийте форму заявки
1. Увійдіть в систему
2. Натисніть "Додати заявку" або "Редагувати" існуючу заявку

### Крок 2: Тестуйте поля з десятковими числами
1. Введіть значення з комою як роздільником (наприклад: 2,5)
2. Перевірте, чи правильно обчислюється сума
3. Перевірте, чи відображається результат з двома знаками після коми

### Крок 3: Перевірте всі розрахункові поля
1. **Олива:** Введіть кількість та ціну, перевірте загальну суму
2. **Масляний фільтр:** Введіть кількість та ціну, перевірте загальну суму
3. **Паливний фільтр:** Введіть кількість та ціну, перевірте загальну суму
4. **Повітряний фільтр:** Введіть кількість та ціну, перевірте загальну суму
5. **Антифриз:** Введіть кількість та ціну, перевірте загальну суму

### Крок 4: Перевірте форматування
1. Всі розрахункові поля повинні показувати два знаки після коми
2. Роздільник повинен бути кома (,) а не крапка (.)
3. Приклад: 205,00 (не 205.00)

---

## ОЧІКУВАНІ РЕЗУЛЬТАТИ

### ✅ Що має працювати:
- Правильне обчислення з десятковими числами
- Підтримка коми як роздільника десяткових знаків
- Відображення результатів з двома знаками після коми
- Автоматичне оновлення розрахункових полів при зміні вхідних даних

### ❌ Що не повинно відбуватися:
- Неправильні обчислення (як 2,5 * 82 = 164)
- Втрата десяткових знаків
- Відображення без форматування (як 205 замість 205,00)
- Помилки при введенні чисел з комою

---

## ДОДАТКОВІ ПЕРЕВІРКИ

### Перевірка сумісності:
1. **Збереження заявки** - всі розрахунки повинні зберігатися правильно
2. **Редагування заявки** - при відкритті заявки розрахунки повинні відображатися правильно
3. **Експорт даних** - при експорті в Excel розрахунки повинні зберігатися
4. **Імпорт даних** - при імпорті з Excel десяткові числа повинні оброблятися правильно

### Перевірка продуктивності:
1. **Швидкість обчислень** - розрахунки повинні виконуватися миттєво
2. **Оновлення полів** - при зміні вхідних даних результати повинні оновлюватися автоматично
3. **Валідація** - система повинна правильно обробляти некоректні введення

---

*Тест створено: Вересень 2025*  
*Версія: 1.0*  
*Статус: Готово до тестування*
